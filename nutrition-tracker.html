<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nutrition Tracker - Meal-E</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üçΩÔ∏è</text></svg>">
    <script>
        (function () {
            const root = document.documentElement;
            root.classList.add('theme-preload');
            try {
                const raw = localStorage.getItem('meale-settings');
                const settings = raw ? JSON.parse(raw) : null;
                if (settings && typeof settings.theme !== 'string' && typeof settings.darkMode === 'boolean') {
                    settings.theme = settings.darkMode ? 'dark' : 'light';
                    try {
                        localStorage.setItem('meale-settings', JSON.stringify(settings));
                    } catch (storageError) {
                        console.warn('Unable to persist theme migration:', storageError);
                    }
                }
                const isDark = settings ? (settings.theme === 'dark' || settings.darkMode === true) : false;
                if (isDark) {
                    root.classList.add('dark-mode');
                    root.style.colorScheme = 'dark';
                    root.style.backgroundColor = '#0f172a';
                    if (!document.getElementById('dark-mode-preload')) {
                        const preloadStyle = document.createElement('style');
                        preloadStyle.id = 'dark-mode-preload';
                        preloadStyle.textContent = 'html, body { background-color: #0f172a !important; color: #e2e8f0 !important; }';
                        (document.head || root).appendChild(preloadStyle);
                    }
                    const darkVars = {
                        '--color-bg': '#0f172a',
                        '--color-bg-muted': '#1e293b',
                        '--color-surface': '#101b2d',
                        '--color-surface-alt': '#152136',
                        '--color-surface-elevated': '#1c2b44',
                        '--color-text': '#e2e8f0',
                        '--color-text-muted': '#94a3b8',
                        '--color-text-subtle': '#c3d1e2',
                        '--color-border': 'rgba(148, 163, 184, 0.18)',
                        '--color-border-strong': 'rgba(148, 163, 184, 0.26)',
                        '--color-divider': 'rgba(71, 85, 105, 0.22)'
                    };
                    Object.keys(darkVars).forEach(function (key) {
                        root.style.setProperty(key, darkVars[key]);
                    });
                }
            } catch (error) {
                console.warn('Unable to apply stored theme preference early:', error);
            }
        })();
    </script>
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body>
    <header>
        <nav>
            <div class="nav-container">
                <a href="mealplan.html" class="logo">Meal-E</a>
                <div class="nav-links">
                    <a href="mealplan.html">Meal Plan</a>
                    <a href="recipes.html">Custom Recipes</a>
                    <a href="ingredients.html">My Ingredients</a>
                    <a href="shopping-lists.html">Shopping Lists</a>
                    <a href="settings.html">Settings</a>
                </div>
            </div>
        </nav>
    </header>

    <main>
        <div class="container">
            <h1>Nutrition Tracker</h1>
            
            <!-- Date Navigation -->
            <div class="date-navigation">
                <button id="prev-day" class="btn btn-secondary">
                    <i class="fas fa-chevron-left"></i> Previous Day
                </button>
                <h2 id="current-date">Today</h2>
                <button id="next-day" class="btn btn-secondary">
                    Next Day <i class="fas fa-chevron-right"></i>
                </button>
            </div>

            <!-- Daily Goals Info -->
            <div class="goals-info">
                <h3>Daily Goals</h3>
                <p>Set your nutrition goals in <a href="settings.html">Settings</a></p>
                <div class="goals-display">
                    <span class="goal-display">Calories: <span id="calorie-goal-display">0</span></span>
                    <span class="goal-display">Protein: <span id="protein-goal-display">0</span>g</span>
                    <span class="goal-display">Carbs: <span id="carbs-goal-display">0</span>g</span>
                    <span class="goal-display">Fat: <span id="fat-goal-display">0</span>g</span>
                </div>
            </div>

            <!-- Daily Progress -->
            <div class="progress-section">
                <h3>Today's Progress</h3>
                <div class="progress-grid">
                    <div class="progress-item">
                        <div class="progress-label">Calories</div>
                        <div class="progress-bar">
                            <div class="progress-fill" id="calorie-progress"></div>
                        </div>
                        <div class="progress-text">
                            <span id="calorie-current">0</span> / <span id="calorie-target">0</span>
                        </div>
                    </div>
                    <div class="progress-item">
                        <div class="progress-label">Protein</div>
                        <div class="progress-bar">
                            <div class="progress-fill" id="protein-progress"></div>
                        </div>
                        <div class="progress-text">
                            <span id="protein-current">0</span> / <span id="protein-target">0</span>g
                        </div>
                    </div>
                    <div class="progress-item">
                        <div class="progress-label">Carbs</div>
                        <div class="progress-bar">
                            <div class="progress-fill" id="carbs-progress"></div>
                        </div>
                        <div class="progress-text">
                            <span id="carbs-current">0</span> / <span id="carbs-target">0</span>g
                        </div>
                    </div>
                    <div class="progress-item">
                        <div class="progress-label">Fat</div>
                        <div class="progress-bar">
                            <div class="progress-fill" id="fat-progress"></div>
                        </div>
                        <div class="progress-text">
                            <span id="fat-current">0</span> / <span id="fat-target">0</span>g
                        </div>
                    </div>
                </div>
            </div>

            <!-- Meal Logging Section -->
            <div class="meals-section">
                <div class="meals-header">
                    <h3>Meal Log</h3>
                    <button id="auto-log-week" class="btn btn-secondary">
                        <i class="fas fa-magic"></i> Auto-Log from Meal Plan
                    </button>
                </div>
                
                <div class="meals-container">
                    <!-- Breakfast -->
                    <div class="meal-group">
                        <div class="meal-header">
                            <h4><i class="fas fa-sun"></i> Breakfast</h4>
                            <button class="btn btn-secondary add-food-btn" data-meal="breakfast">
                                <i class="fas fa-plus"></i> Add Food
                            </button>
                        </div>
                        <div class="meal-items" id="breakfast-items">
                            <div class="no-items">No foods logged yet</div>
                        </div>
                        <div class="meal-totals" id="breakfast-totals">
                            <span>0 calories</span>
                        </div>
                    </div>

                    <!-- Lunch -->
                    <div class="meal-group">
                        <div class="meal-header">
                            <h4><i class="fas fa-cloud-sun"></i> Lunch</h4>
                            <button class="btn btn-secondary add-food-btn" data-meal="lunch">
                                <i class="fas fa-plus"></i> Add Food
                            </button>
                        </div>
                        <div class="meal-items" id="lunch-items">
                            <div class="no-items">No foods logged yet</div>
                        </div>
                        <div class="meal-totals" id="lunch-totals">
                            <span>0 calories</span>
                        </div>
                    </div>

                    <!-- Dinner -->
                    <div class="meal-group">
                        <div class="meal-header">
                            <h4><i class="fas fa-moon"></i> Dinner</h4>
                            <button class="btn btn-secondary add-food-btn" data-meal="dinner">
                                <i class="fas fa-plus"></i> Add Food
                            </button>
                        </div>
                        <div class="meal-items" id="dinner-items">
                            <div class="no-items">No foods logged yet</div>
                        </div>
                        <div class="meal-totals" id="dinner-totals">
                            <span>0 calories</span>
                        </div>
                    </div>

                    <!-- Snacks -->
                    <div class="meal-group">
                        <div class="meal-header">
                            <h4><i class="fas fa-cookie-bite"></i> Snacks</h4>
                            <button class="btn btn-secondary add-food-btn" data-meal="snacks">
                                <i class="fas fa-plus"></i> Add Food
                            </button>
                        </div>
                        <div class="meal-items" id="snacks-items">
                            <div class="no-items">No foods logged yet</div>
                        </div>
                        <div class="meal-totals" id="snacks-totals">
                            <span>0 calories</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Add Food Modal -->
    <div id="add-food-modal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h2>Add Food to <span id="modal-meal-name">Meal</span></h2>
            
            <div class="food-search-section">
                <div class="form-group">
                    <label for="food-search">Search Foods</label>
                    <input type="text" id="food-search" placeholder="Search custom ingredients, USDA database, or recipes...">
                </div>
                
                <div class="search-results" id="food-search-results">
                    <!-- Search results will appear here -->
                </div>
            </div>

            <div class="selected-food-section" id="selected-food-section" style="display: none;">
                <h3>Selected Food</h3>
                <div id="selected-food-details"></div>
                
                <div class="form-group">
                    <label for="food-amount">Amount (g)</label>
                    <input type="number" id="food-amount" min="0" step="0.1" value="100" placeholder="Enter amount in grams">
                </div>
                
                <div class="nutrition-preview" id="nutrition-preview">
                    <!-- Nutrition preview will appear here -->
                </div>
            </div>

            <div class="form-actions">
                <button type="button" class="btn btn-secondary" id="cancel-add-food">Cancel</button>
                <button type="button" class="btn btn-primary" id="add-food-to-meal">Add to Meal</button>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="js/nutrition-tracker.js" type="module"></script>
    <script src="js/footer.js" type="module"></script>
</body>
</html> 